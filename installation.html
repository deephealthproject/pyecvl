

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Installation &mdash; PyECVL  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Getting Started" href="getting_started.html" />
    <link rel="prev" title="Welcome to PyECVL’s documentation!" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> PyECVL
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#install-ecvl-and-eddl-dependencies">Install ECVL and EDDL dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="#install-eddl-and-ecvl">Install EDDL and ECVL</a></li>
<li class="toctree-l2"><a class="reference internal" href="#install-pyeddl-and-pyecvl">Install PyEDDL and PyECVL</a></li>
<li class="toctree-l2"><a class="reference internal" href="#disabling-unwanted-modules">Disabling unwanted modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ecvl-installed-in-an-arbitrary-directory">ECVL installed in an arbitrary directory</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/ecvl.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pyecvl.ecvl</span></code> — ecvl API</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">PyECVL</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Installation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/installation.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="installation">
<span id="id1"></span><h1>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We recommend using the <a class="reference external" href="https://github.com/deephealthproject/docker-libs">DeepHealth Docker images</a>, which provide
ready-to-use containers for the DeepHealth components, including
PyECVL. If you want to install PyECVL manually instead, read on.</p>
</div>
<p>To install PyECVL, you need to install ECVL first. Installation instructions
for ECVL are available in the <a class="reference external" href="https://github.com/deephealthproject/ecvl/blob/master/README.md">ECVL README</a>.</p>
<p>As shown in the above README, Some ECVL components are optional. By
default, PyECVL assumes that ECVL has been installed with DICOM, OpenSlide and
EDDL support.</p>
<p>The latter enables an ECVL module that allows to interact with <a class="reference external" href="https://github.com/deephealthproject/eddl">EDDL</a>, the European Distributed Deep
Learning library (e.g., to convert ECVL images to/from EDDL tensors). In order
to use the same functionalities in Python, you need to install EDDL and its
Python version, <a class="reference external" href="https://github.com/deephealthproject/pyeddl">PyEDDL</a>. Each
PyECVL version depends on specific ECVL and PyEDDL versions. If you are
installing from the GitHub repo, the correct versions of ECVL and PyEDDL are
available from the submodules (<code class="docutils literal notranslate"><span class="pre">third_party</span></code> dir).</p>
<p>The following sections contain instructions to install PyECVL from scratch,
assuming installation of all EDDL and ECVL optional modules. We use Ubuntu
Linux as an example platform.</p>
<div class="section" id="install-ecvl-and-eddl-dependencies">
<h2>Install ECVL and EDDL dependencies<a class="headerlink" href="#install-ecvl-and-eddl-dependencies" title="Permalink to this headline">¶</a></h2>
<p>ECVL needs a compiler with C++17 support, such as gcc-8 or later. You also
need to install the development version of the OpenCV and OpenSlide
libraries. EDDL needs the development versions of the zlib and Eigen3
libraries. To enable ONNX I/O, you also need to install Google protobuf. On
Ubuntu, for instance, install the following with APT: <code class="docutils literal notranslate"><span class="pre">gcc-8,</span> <span class="pre">g++-8,</span>
<span class="pre">libopencv-dev,</span> <span class="pre">libopenslide-dev,</span> <span class="pre">zlib1g-dev,</span> <span class="pre">libeigen3-dev,</span> <span class="pre">wget,</span>
<span class="pre">ca-certificates</span></code>. Install protobuf from source:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>wget -q https://github.com/protocolbuffers/protobuf/releases/download/v3.11.4/protobuf-all-3.11.4.tar.gz
tar xf protobuf-all-3.11.4.tar.gz
cd protobuf-3.11.4
./configure
make -j$(nproc)
make install
</pre></div>
</div>
</div>
<div class="section" id="install-eddl-and-ecvl">
<h2>Install EDDL and ECVL<a class="headerlink" href="#install-eddl-and-ecvl" title="Permalink to this headline">¶</a></h2>
<p>Clone the GitHub repo:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="o">--</span><span class="n">recurse</span><span class="o">-</span><span class="n">submodules</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">deephealthproject</span><span class="o">/</span><span class="n">pyecvl</span><span class="o">.</span><span class="n">git</span>
<span class="n">cd</span> <span class="n">pyecvl</span>
</pre></div>
</div>
<p>Install EDDL:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>pushd pyecvl/third_party/pyeddl/third_party/eddl
mkdir build
pushd build
cmake -D BUILD_SHARED_LIB=ON -D BUILD_PROTOBUF=ON -D BUILD_TESTS=OFF
make -j$(nproc)
make install
popd
popd
</pre></div>
</div>
<p>Install ECVL:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>pushd third_party/ecvl
mkdir build
pushd build
cmake -DECVL_WITH_DICOM=ON -DECVL_WITH_OPENSLIDE=ON -DECVL_DATASET=ON -DECVL_BUILD_EDDL=ON
make -j$(nproc)
make install
popd
popd
</pre></div>
</div>
</div>
<div class="section" id="install-pyeddl-and-pyecvl">
<h2>Install PyEDDL and PyECVL<a class="headerlink" href="#install-pyeddl-and-pyecvl" title="Permalink to this headline">¶</a></h2>
<p>You need the development version of python3 and pip. On Ubuntu, install
<code class="docutils literal notranslate"><span class="pre">python3-dev</span></code> and <code class="docutils literal notranslate"><span class="pre">python3-pip</span></code>.</p>
<p>Install the Python dependencies:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="o">-</span><span class="n">m</span> <span class="n">pip</span> <span class="n">install</span> <span class="o">--</span><span class="n">upgrade</span> <span class="n">setuptools</span> <span class="n">pip</span> <span class="n">numpy</span> <span class="n">pybind11</span> <span class="n">pytest</span>
</pre></div>
</div>
<p>The EDDL code includes Eigen headers like in this example: <code class="docutils literal notranslate"><span class="pre">#include</span>
<span class="pre">&lt;Eigen/Dense&gt;</span></code>, e.g., with <code class="docutils literal notranslate"><span class="pre">Eigen</span></code> as the root directory. However, Eigen
installations usually have the header rooted at <code class="docutils literal notranslate"><span class="pre">eigen3</span></code> (for instance, the
apt installation places them in <code class="docutils literal notranslate"><span class="pre">/usr/include/eigen3</span></code>). To work around this
you can either add a symlink or set <code class="docutils literal notranslate"><span class="pre">CPATH</span></code>, e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">CPATH</span><span class="o">=</span><span class="s2">&quot;/usr/include/eigen3:$</span><span class="si">{CPATH}</span><span class="s2">&quot;</span>
</pre></div>
</div>
<p>Install pyeddl and pyecvl:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pushd</span> <span class="n">third_party</span><span class="o">/</span><span class="n">pyeddl</span>
<span class="n">python3</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">install</span>
<span class="n">popd</span>
<span class="n">python3</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">install</span>
</pre></div>
</div>
<p>Alternatively, in the case of tagged releases, you can also install PyEDDL and
PyECVL with pip. The following table shows the required ECVL and PyEDDL
versions for each PyECVL version:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 35%" />
<col style="width: 30%" />
<col style="width: 35%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>PyECVL version</p></th>
<th class="head"><p>ECVL version</p></th>
<th class="head"><p>PyEDDL version</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0.1.0</p></td>
<td><p>0.1.0</p></td>
<td><p>0.1.0</p></td>
</tr>
<tr class="row-odd"><td><p>0.2.0</p></td>
<td><p>0.2.0</p></td>
<td><p>0.6.0</p></td>
</tr>
</tbody>
</table>
<p>Thus, for instance, to install PyECVL 0.2.0:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="o">-</span><span class="n">m</span> <span class="n">pip</span> <span class="n">install</span> <span class="n">pyeddl</span><span class="o">==</span><span class="mf">0.6</span><span class="o">.</span><span class="mi">0</span>
<span class="n">python3</span> <span class="o">-</span><span class="n">m</span> <span class="n">pip</span> <span class="n">install</span> <span class="n">pyecvl</span><span class="o">==</span><span class="mf">0.2</span><span class="o">.</span><span class="mi">0</span>
</pre></div>
</div>
</div>
<div class="section" id="disabling-unwanted-modules">
<h2>Disabling unwanted modules<a class="headerlink" href="#disabling-unwanted-modules" title="Permalink to this headline">¶</a></h2>
<p>By default, PyECVL assumes a complete ECVL installation, including optional
modules (except for the GUI), and builds bindings for all of them. You can
disable support for specific modules via environment variables. For instance,
suppose you installed ECVL without OpenSlide support: by default, PyECVL will
try to build the bindings for OpenSlide-specific ECVL tools and link the
OpenSlide library, which might not even be present on your system. To avoid
this, set the <code class="docutils literal notranslate"><span class="pre">ECVL_WITH_OPENSLIDE</span></code> environment variable to <code class="docutils literal notranslate"><span class="pre">OFF</span></code> (or
<code class="docutils literal notranslate"><span class="pre">FALSE</span></code>) before building PyECVL. Similarly, you can turn off DICOM and EDDL
support by setting <code class="docutils literal notranslate"><span class="pre">ECVL_WITH_DICOM</span></code> and <code class="docutils literal notranslate"><span class="pre">ECVL_EDDL</span></code> to <code class="docutils literal notranslate"><span class="pre">OFF</span></code>.</p>
</div>
<div class="section" id="ecvl-installed-in-an-arbitrary-directory">
<h2>ECVL installed in an arbitrary directory<a class="headerlink" href="#ecvl-installed-in-an-arbitrary-directory" title="Permalink to this headline">¶</a></h2>
<p>The above installation instructions assume installation in standard system
paths (such as <code class="docutils literal notranslate"><span class="pre">/usr/local/include</span></code>, <code class="docutils literal notranslate"><span class="pre">/usr/local/lib</span></code>). However, ECVL can
be installed in an arbitrary directory, for instance:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">third_party</span><span class="o">/</span><span class="n">ecvl</span>
<span class="n">mkdir</span> <span class="n">build</span>
<span class="n">cd</span> <span class="n">build</span>
<span class="n">cmake</span> <span class="o">-</span><span class="n">DCMAKE_INSTALL_PREFIX</span><span class="o">=/</span><span class="n">home</span><span class="o">/</span><span class="n">myuser</span><span class="o">/</span><span class="n">ecvl</span> <span class="o">-</span><span class="n">DECVL_WITH_DICOM</span><span class="o">=</span><span class="n">ON</span> \
  <span class="o">-</span><span class="n">DECVL_WITH_OPENSLIDE</span><span class="o">=</span><span class="n">ON</span> <span class="o">-</span><span class="n">DECVL_DATASET</span><span class="o">=</span><span class="n">ON</span> <span class="o">-</span><span class="n">DECVL_BUILD_EDDL</span><span class="o">=</span><span class="n">ON</span> <span class="o">..</span>
<span class="n">make</span>
<span class="n">make</span> <span class="n">install</span>
</pre></div>
</div>
<p>You can tell the PyECVL setup script about this via the <code class="docutils literal notranslate"><span class="pre">ECVL_DIR</span></code>
environment variable:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">ECVL_DIR</span><span class="o">=/</span><span class="n">home</span><span class="o">/</span><span class="n">myuser</span><span class="o">/</span><span class="n">ecvl</span>
<span class="n">python3</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">install</span>
</pre></div>
</div>
<p>In this way, <code class="docutils literal notranslate"><span class="pre">setup.py</span></code> will look for additional include files in
<code class="docutils literal notranslate"><span class="pre">/home/myuser/ecvl/include</span></code> and for additional libraries in
<code class="docutils literal notranslate"><span class="pre">/home/myuser/ecvl/lib</span></code>.</p>
<p>Similarly, if EDDL is installed in an arbitrary path, you can tell the setup
script via the <code class="docutils literal notranslate"><span class="pre">EDDL_DIR</span></code> environment variable.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="getting_started.html" class="btn btn-neutral float-right" title="Getting Started" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="Welcome to PyECVL’s documentation!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019-2020, CRS4

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>